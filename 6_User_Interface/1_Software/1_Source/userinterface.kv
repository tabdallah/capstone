# Screen layout definitions

<IntroScreen>:
    orientation: 'vertical'
    canvas:
        Rectangle:
            source: (app.app_images_filepath + 'logo.png')
            pos: root.pos 
            size: root.size

<MenuScreen>:
    orientation: 'vertical'
    canvas.before:
        Color:
            rgba: (1,1,1,0.7)
        Rectangle:
            source: (app.app_images_filepath + 'menu_background.jpg')
            pos: root.pos
            size: root.size
    ScreenLabel:
        text: "Main Menu"
    LineSeparator:
    BoxLayout:
        orientation: 'horizontal'
        BoxLayout:
            orientation: 'vertical'
            padding: 10
            spacing: 10
            MainMenuButton:
                text: "Play Against Robot"
                on_release: root.manager.current = 'visual'
            MainMenuButton:
                text: "Settings"
                on_release: root.manager.current = 'settings'
        BoxLayout:
            orientation: 'vertical'
            padding: 10
            spacing: 10
            MainMenuButton:
                text: "Play Using Robot"
                on_release: root.manager.current = 'manual'
            MainMenuButton:
                text: "Diagnostics"
                on_release: root.manager.current = 'diagnostics'
            
        BoxLayout:
            orientation: 'vertical'
            padding: 10
            spacing: 10
            MainMenuButton:
                text: "Demo"
                on_release: root.manager.current = 'demo'
            MainMenuButton:
                text: "Quit"
                on_release: root.go_quit()

<VisualScreen>:
    orientation: 'horizontal'
    padding: 5
    spacing: 5
    canvas.before:
        Color:
            rgba: (1,1,1,0.4)
        Rectangle:
            source: (app.app_images_filepath + 'menu_background.jpg')
            pos: root.pos 
            size: root.size
    CameraData:
        id: camera_data
    GameControl:
        id: game_control
        size_hint: (0.3,1)

<ManualScreen>:
    orientation: 'horizontal'
    canvas.before:
        Color:
            rgba: (1,1,1,0.4)
        Rectangle:
            source: (app.app_images_filepath + 'menu_background.jpg')
            pos: root.pos 
            size: root.size
    ManualPlayingSurface:
        id: playing_surface
    GameControl:
        id: game_control
        size_hint: (0.3,1)

<DiagnosticsScreen>:
    orientation: 'vertical'
    canvas.before:
        Color:
            rgba: (1,1,1,0.5)
        Rectangle:
            source: (app.app_images_filepath + 'menu_background.jpg')
            pos: root.pos 
            size: root.size
    ScreenLabel:
        text: "Diagnostics"
    LineSeparator:
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            orientation: 'horizontal'
            SettingsLabel:
            SettingsLabel:
                text: "[u]State[/u]"
                markup: True
            SettingsLabel:
                text: "[u]Error[/u]"
                markup: True
        LineSeparator2:
        BoxLayout:
            orientation: 'horizontal'
            SettingsLabel:
                text: "Master Controller"
            SettingsLabel:
                id: mc_state_label
                text: "null"
            SettingsLabel:
                id: mc_error_label
                text: "null"
        LineSeparator2:
        BoxLayout:
            orientation: 'horizontal'
            SettingsLabel:
                text: "User Interface"
            SettingsLabel:
                id: ui_state_label
                text: "null"
            SettingsLabel:
                id: ui_error_label
                text: "null"
        LineSeparator2:
        BoxLayout:
            orientation: 'horizontal'
            SettingsLabel:
                text: "Puck Tracker"
            SettingsLabel:
                id: pt_state_label
                text: "null"
            SettingsLabel:
                id: pt_error_label
                text: "null"
        LineSeparator2:
        BoxLayout:
            orientation: 'horizontal'
            SettingsLabel:
                text: "Paddle Controller"
            SettingsLabel:
                id: pc_state_label
                text: "null"
            SettingsLabel:
                id: pc_error_label
                text: "null"
        LineSeparator2:
        BoxLayout:
            orientation: 'horizontal'
            padding: 5
            spacing: 5
            SquareButton:
                text: "Calibrate Puck Tracker"
                on_release: root.manager.current = 'fiducial_calibration'
            SquareButton:
                text: "Calibrate Paddle Controller"
                on_release: root.calibrate_paddle_controller()
        BoxLayout:
            orientation: 'horizontal'
            padding: 5
            spacing: 5
            SquareButton:
                text: "Clear Errors"
                on_release: root.clear_errors() 
            SquareButton:
                text: "Main Menu"
                on_release: root.manager.current = 'menu'

<SettingsScreen>:
    orientation: 'vertical'
    canvas.before:
        Color:
            rgba: (1,1,1,0.6)
        Rectangle:
            source: (app.app_images_filepath + 'menu_background.jpg')
            pos: root.pos 
            size: root.size
    ScreenLabel:
        text: "Settings"
    LineSeparator:
    BoxLayout:
        spacing: 5
        padding: 5
        orientation: 'vertical'
        BoxLayout:
            padding: 5
            spacing: 5
            orientation: 'horizontal'
            SettingsLabel:
                text: "Game Mode:"
            SettingsButton:
                id: offense_button
                text: "Offense"
                group: "game_mode"
                on_release: root.change_game_setting()
            SettingsButton:
                id: defense_button
                text: "Defense"
                group: "game_mode"
                on_release: root.change_game_setting()
            Label:
        BoxLayout:
            padding: 5
            spacing: 5
            orientation: 'horizontal'
            SettingsLabel:
                text: "Game Length:"
            SettingsButton:
                id: one_min_button
                text: "1:00"
                group: "game_length"
                on_release: root.change_game_setting()
            SettingsButton:
                id: two_min_button
                text: "2:00"
                group: "game_length"
                on_release: root.change_game_setting()
            SettingsButton:
                id: five_min_button
                text: "5:00"
                group: "game_length"
                on_release: root.change_game_setting()
        BoxLayout:
            padding: 5
            spacing: 5
            orientation: 'horizontal'
            SettingsLabel:
                text: "X-Axis Speed:"
            SettingsButton:
                id: slow_button_x
                text: "Slow"
                group: "game_speed_x"
                on_release: root.change_game_setting()
            SettingsButton:
                id: medium_button_x
                text: "Medium"
                group: "game_speed_x"
                on_release: root.change_game_setting()
            SettingsButton:
                id: fast_button_x
                text: "Fast"
                group: "game_speed_x"
                on_release: root.change_game_setting()
        BoxLayout:
            padding: 5
            spacing: 5
            orientation: 'horizontal'
            SettingsLabel:
                text: "Y-Axis Speed:"
            SettingsButton:
                id: slow_button_y
                text: "Slow"
                group: "game_speed_y"
                on_release: root.change_game_setting()
            SettingsButton:
                id: medium_button_y
                text: "Medium"
                group: "game_speed_y"
                on_release: root.change_game_setting()
            SettingsButton:
                id: fast_button_y
                text: "Fast"
                group: "game_speed_y"
                on_release: root.change_game_setting()
        SquareButton:
            text: "Main Menu"
            on_release: root.go_menu()

<DemoScreen>:
    orientation: 'vertical'
    canvas:
        Rectangle:
            source: (app.app_images_filepath + 'menu_background.jpg')
            pos: root.pos 
            size: root.size
    ScreenLabel:
        text: "Demo"
    LineSeparator:    
    BoxLayout:
        orientation: 'vertical'
        padding: 5
        SquareButton:
            text: "Main Menu"
            on_release: root.manager.current = 'menu'

<FiducialCalibrationScreen>:
    orientation: 'vertical'
    padding: 5
    canvas:
        Color:
            rgba: (1,1,1,0.5)
        Rectangle:
            source: (app.app_images_filepath + 'menu_background.jpg')
            pos: root.pos 
            size: root.size
    ScreenLabel:
        text: root.action_label
    Label:
        text: root.instruction_label
        outline_width: 1
        outline_color: (0,0,0)
        size_hint: (1,0.1)
        font_size: 20 
    LineSeparator:
    BoxLayout:
        orientation: 'horizontal'
        spacing: 5
        BoxLayout:
            id: slider_layout
            orientation: 'vertical'
            BoxLayout:
                orientation: 'horizontal'
                ColorCalibrationLabel:
                    text: "Hue Lower: %s" % int(lower_hue.value)
                Slider:
                    id: lower_hue
                    min: 0
                    max: 179
            BoxLayout:
                orientation: 'horizontal'
                ColorCalibrationLabel:
                    text: "Sat Lower: %s" % int(lower_sat.value)
                Slider:
                    id: lower_sat
                    min: 0
                    max: 255
            BoxLayout:
                orientation: 'horizontal'
                ColorCalibrationLabel:
                    text: "Val Lower: %s" % int(lower_val.value)
                Slider:
                    id: lower_val
                    min: 0
                    max: 255
            BoxLayout:
                orientation: 'horizontal'
                ColorCalibrationLabel:
                    text: "Hue Upper: %s" % int(upper_hue.value)
                Slider:
                    id: upper_hue
                    min: 0
                    max: 179
            BoxLayout:
                orientation: 'horizontal'
                ColorCalibrationLabel:
                    text: "Sat Upper: %s" % int(upper_sat.value)
                Slider:
                    id: upper_sat
                    min: 0
                    max: 255
            BoxLayout:
                orientation: 'horizontal'
                ColorCalibrationLabel:
                    text: "Val Upper: %s" % int(upper_val.value)
                Slider:
                    id: upper_val
                    min: 0
                    max: 255
        CameraData:
            id: camera_data
    BoxLayout:
        orientation: 'horizontal'
        size_hint: (1,0.2)
        spacing: 5
        SquareButton:
            text: "Back to Diagnostics"
            on_release: root.manager.current = 'diagnostics'
        SquareButton:
            id: skip_redo_button
            text: "Skip"
            on_release: root.skip_redo_button()
        SquareButton:
            id: calibrate_continue_button
            text: "Save & Calibrate"
            on_release: root.calibrate_continue_button()

<PuckCalibrationScreen>:
    orientation: 'vertical'
    padding: 5
    canvas:
        Color:
            rgba: (1,1,1,0.5)
        Rectangle:
            source: (app.app_images_filepath + 'menu_background.jpg')
            pos: root.pos 
            size: root.size
    ScreenLabel:
        text: root.action_label
    Label:
        text: root.instruction_label
        outline_width: 1
        outline_color: (0,0,0)
        size_hint: (1,0.1)
        font_size: 20 
    LineSeparator:
    BoxLayout:
        orientation: 'horizontal'
        spacing: 5
        BoxLayout:
            id: slider_layout
            orientation: 'vertical'
            BoxLayout:
                orientation: 'horizontal'
                ColorCalibrationLabel:
                    text: "Hue Lower: %s" % int(lower_hue.value)
                Slider:
                    id: lower_hue
                    min: 0
                    max: 179
            BoxLayout:
                orientation: 'horizontal'
                ColorCalibrationLabel:
                    text: "Sat Lower: %s" % int(lower_sat.value)
                Slider:
                    id: lower_sat
                    min: 0
                    max: 255
            BoxLayout:
                orientation: 'horizontal'
                ColorCalibrationLabel:
                    text: "Val Lower: %s" % int(lower_val.value)
                Slider:
                    id: lower_val
                    min: 0
                    max: 255
            BoxLayout:
                orientation: 'horizontal'
                ColorCalibrationLabel:
                    text: "Hue Upper: %s" % int(upper_hue.value)
                Slider:
                    id: upper_hue
                    min: 0
                    max: 179
            BoxLayout:
                orientation: 'horizontal'
                ColorCalibrationLabel:
                    text: "Sat Upper: %s" % int(upper_sat.value)
                Slider:
                    id: upper_sat
                    min: 0
                    max: 255
            BoxLayout:
                orientation: 'horizontal'
                ColorCalibrationLabel:
                    text: "Val Upper: %s" % int(upper_val.value)
                Slider:
                    id: upper_val
                    min: 0
                    max: 255
        CameraData:
            id: camera_data
    BoxLayout:
        orientation: 'horizontal'
        size_hint: (1,0.2)
        spacing: 5
        SquareButton:
            text: "Back to Diagnostics"
            on_release: root.manager.current = 'diagnostics'
        SquareButton:
            text: "Skip"
            on_release: root.manager.current = 'diagnostics'
        SquareButton:
            id: calibrate_button
            text: "Save & Calibrate"
            on_release: root.calibrate_button()

# Widget definitions

<GameControl>:
    orientation: 'vertical'
    spacing: 5
    Label:
        text: root.game_clock_label
        outline_width: 1.3
        outline_color: (0,0,0)
        font_size: 80
        color: (1,0,0,1)
    LineSeparator2:
    BoxLayout:
        orientation: 'horizontal'
        BoxLayout:
            orientation: 'vertical'
            Label:
                text: "Robot"
                outline_width: 1.3
                outline_color: (0,0,0)
                font_size: 30
                size_hint: (1,0.6)
            Label:
                text: root.robot_score_label
                outline_width: 1.3
                outline_color: (0,0,0)      
                font_size: 60
        BoxLayout:
            orientation: 'vertical'
            Label:
                text: "Human"
                outline_width: 1.3
                outline_color: (0,0,0)
                font_size: 30
                size_hint: (1,0.6)
            Label:
                text: root.human_score_label
                outline_width: 1.3
                outline_color: (0,0,0)
                font_size: 60
    LineSeparator2:
    SquareButton:
        id: start_reset_game_button
        text: "Start Game"
        on_release: root.start_reset_game()
    SquareButton:
        id: pause_resume_game_button
        disabled: True
        text: "Pause Game"
        on_release: root.pause_resume_game()
    SquareButton:
        text: "Main Menu"
        on_release: root.go_menu()

<ManualPaddle>:
    Image:
        id: paddle_image
        source: (app.app_images_filepath + 'paddle.png')

<ManualPlayingSurface>:
    canvas:
        Color:
            rgba: (1,1,1,1)
        Rectangle:
            source: (app.app_images_filepath + 'hockeySurface.png')
            pos: self.pos
            size: self.size
    ManualPaddle:
        id: paddle
        center: self.parent.center

<LineSeparator>:
    id: line_separator  
    size_hint_y: None
    height: 6
    canvas:
        Color:
            rgba: 0, 0.4, 1, 0.4
        Rectangle:
            pos: self.pos[0], line_separator.center_y
            size: line_separator.width, 6

<LineSeparator2>:
    id: line_separator  
    size_hint_y: None
    height: 2
    canvas:
        Color:
            rgba: 1, 1, 1, 0.4
        Rectangle:
            pos: self.pos[0], line_separator.center_y
            size: line_separator.width, 3

# Dynamic class definitions

<SquareButton@Button>:
    text: root.text
    on_release: root.on_release
    outline_width: 1.3
    outline_color: (0,0,0)
    font_size: 30
    background_normal: ('../../../6_User_Interface/1_Software/2_Images/menu_unclicked.png')
    background_down: ('../../../6_User_Interface/1_Software/2_Images/menu_clicked.png')

<SettingsLabel@Label>:
    id: root.id
    text: root.text
    font_size: 30
    outline_width: 1.3
    outline_color: (0,0,0)

<SettingsButton@ToggleButton>:
    id: root.id
    text: root.text
    on_release: root.on_release
    group: root.group
    allow_no_selection: False
    outline_width: 1.6
    outline_color: (0,0,0)
    font_size: 30
    background_normal: ('../../../6_User_Interface/1_Software/2_Images/settings_unclicked.png')
    background_down: ('../../../6_User_Interface/1_Software/2_Images/settings_clicked.png')

<MainMenuButton@Button>:
    text: root.text
    on_release: root.on_release
    outline_width: 1.3
    outline_color: (0,0,0)
    font_size: 35
    background_normal: ('../../../6_User_Interface/1_Software/2_Images/unclicked.png')
    background_down: ('../../../6_User_Interface/1_Software/2_Images/clicked.png')

<ScreenLabel@Label>:
    text: root.text
    outline_width: 1
    outline_color: (0,0,0)
    size_hint: (1,0.2)
    font_size: 50 

<ColorCalibrationLabel@Label>:
    text: root.text
    outline_width: 1
    outline_color: (0,0,0)
    size_hint: (0.4,1)
    font_size: 20 
    text_size: self.size
    valign: "middle"